---
import BaseLayout from '../lib/layouts/BaseLayout.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../lib/constants';
import FormattedDate from '../lib/components/FormattedDate.astro';
import { getCollection, type CollectionEntry } from 'astro:content';

const posts = (await getCollection('blog')) as CollectionEntry<'blog'>[];
posts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
  <!-- Hero Section -->
  <section class="bg-dotted-fade bg-back py-20 w-full border-b">
    <div class="max-w-3xl main-container text-center">
      <h1 class="text-4xl md:text-5xl font-bold mb-6">
        Hey there! Welcome to the <span class="text-primary">MEMsched</span> blog
      </h1>
      <p class="text md:text-xl text-muted-foreground mb-8 max-w-2xl mx-auto">
        Just some thoughts on learning stuff, staying productive, and keeping track of what you've
        learned along the way
      </p>
      <!-- <div class="flex justify-center gap-4">
        <a
          href="#latest-posts"
          class="px-6 py-2 bg-primary text-primary-foreground rounded-md hover:opacity-90 transition-opacity"
        >
          Check Out Recent Posts
        </a>
        <a
          href="/posts/archive"
          class="px-6 py-2 border border-input rounded-md hover:bg-accent hover:text-accent-foreground transition-colors"
        >
          See Everything
        </a>
      </div> -->
    </div>
  </section>

  <section class="space-y-8 main-container py-20">
    <h2 class="h2 text-3xl">Latest Posts</h2>
    <div class="divide-y space-y-4 *:pt-8">
      {
        posts.map((post) => (
          <a href={`/posts/${post.id}`} class="group block">
            <article class="pb-8 hover:bg-accent/5 rounded-md p-4 -m-4 transition-colors">
              <h2 class="text-2xl font-semibold mb-2 group-hover:text-primary transition-colors">
                {post.data.title}
              </h2>
              <p class="text-gray-600 mb-4">{post.data.description}</p>
              <FormattedDate date={post.data.pubDate} />
            </article>
          </a>
        ))
      }
    </div>
  </section>

  <!-- CTA section -->
  <section class="bg-dotted-fade bg-back py-16 w-full border-t">
    <div
      class="main-container flex flex-col md:flex-row items-center justify-between gap-8 text-center md:text-left text-primary"
    >
      <div>
        <h2 class="text-3xl font-bold mb-2">Want to track your own progress?</h2>
        <p class="text-lg text-primary/75">
          Turn reading about learning into actual learning progress you can track and share!
        </p>
      </div>
      <div class="flex flex-col items-center">
        <a
          href="https://memsched.com/auth/signin"
          class="px-8 py-3 bg-primary text-primary-foreground rounded-md text-lg font-medium hover:opacity-90 transition-opacity"
        >
          Start tracking for free
        </a>
        <p class="mt-2 text-sm text-muted-foreground">No credit card needed.</p>
      </div>
    </div>
  </section>
</BaseLayout>
